<html>
<head>
	<title>Transcrição de Fala em Tempo Real - IDIOMA INGLES</title>
	<script src="https://cdn.jsdelivr.net/npm/translate-js/dist/translate.min.js"></script>
</head>
<body>    
	<table border="2" width="100%">
		<TR>
			<TD width="50%" valign="bottom" >
				<div>
					<p>Texto em inglês: <span id="english-word">0</span></p>
					<p><span id="portuguese-word"></span></p>

					<button id="start-btn">Começar</button>
				</div>
			</td>
			<td width="50%">
				<div id="transcription"></div>
			</td>
		</tr>
	</table>

<script>
var element = document.getElementById('transcription');
var lastScrollTop = element.scrollTop;

const translate = window.translate;
const englishWord =document.getElementById('english-word');
const portugueseWord =document.getElementById('portuguese-word')
const sourceLang = 'en';
const targetLang = 'pt';
if ('webkitSpeechRecognition' in window) {
	const recognition = new webkitSpeechRecognition();
	recognition.lang = 'pt-BR';			
	recognition.lang = 'en-US';
	recognition.continuous = true;
	recognition.interimResults = true;

	const transcription = document.getElementById('transcription');

	document.getElementById('start-btn').addEventListener('click', function() {
	recognition.start();
	});

	recognition.onresult = function(event) {
		let interimTranscription = '';
		for (let i = event.resultIndex; i < event.results.length; ++i) {
			if (event.results[i].isFinal) {
				transcription.innerHTML += event.results[i][0].transcript;
			} else {
				interimTranscription += event.results[i][0].transcript;
			}
		}
		if (interimTranscription) {
			englishWord.innerText = interimTranscription;
			translate(englishWord.innerText, sourceLang, targetLang).then(function(translation) {
				portugueseWord.innerText = translation;
			});
			transcription.innerHTML += interimTranscription;
		} window.scrollTo(0,document.body.scrollHeight);
	};
} else {
			alert('A API de Reconhecimento de Fala não é suportada neste navegador');
	   }
</script>
</body>
</html>